# C++ を用いた機械学習への導入
コンピュータで問題を解くには様々なアプローチがあります．
明示的にアルゴリズムを定義する方法もあれば，数学や統計的方法に基づく暗黙的な方策もあります．
**機械学習** (ML: Machine Learning) はタスクの解決に数学的，統計的アプローチを用いる，暗黙的な手法の1種です．
現在，活発に研究が進められている分野で，多くの科学者，研究者が人間と同水準に機能する**人工知能** (AI: Artificial Intelligence) システムを前進させるのに最適な方法であると考えています．  
一般的に，機械学習アプローチでは，その基礎として与えられたデータセットからパターンを探し出そうとします．
ニュースの配信を行うおすすめシステムを想像してみてください．
そのシステムでは，ユーザの過去の行動や好みに基づいて，個々の好みに合わせた配信内容を提供してくれます．
ソフトウェアはユーザが過去に読んだニュース記事の情報を収集し，何らかの統計情報を計算します．
例えば，それはニュース記事のトピックの出現頻度かもしれません．
その後，予測的な解析を行って普遍的なパターンを特定し，ニュースの配信に役立てます．
そのようなシステムではユーザの活動を定期的に追跡し，データセットの更新とおすすめの新しい傾向の算出を行います．  
機械学習は多くの分野で重要な役割を果たすようになってきています．
科学的な研究に加えて企業のビジネスに関わる問題の解決にも使われ流ようになりました．
顧客管理 (CRM: Customer Relationship Management) システムでは，営業チームの活動を解析して，最初に最も重要なリクエストを処理してくれます．
また，ビジネスインテリジェンス (BI: Business Intelligence) では機械学習モデルを用いた解析で，重要なデータ点を発見します．
さらに，人材 (HR: Human Resource) 関連の部署においては，各被雇用者の特性を解析して最も秀でた特性を見つけ出し，空いているポジションでどこが最適かを探索します．  
自動運転車の研究は成長著しく，この分野では深層学習ニューラルネットワークが大規模に用いられています．
それらは，車の運転に必要なナビゲーションやハンドル操作に加えて，物体の特定といったコンピュータビジョン系のシステムで使われています．  
機械学習システムの他の使い道としては，Apple の Siri や Amazon の Alexa のような電子的な個人支援があります．
このような製品では，ユーザの要求を処理するのに実際の喋り声や書かれている文字を解析して，文脈に沿った自然な反応を返すのに深層学習モデルを用いています．
その要求というのは，ユーザのスケジュールを更新したり，フライトを予約したりということかもしれませんし，好みの曲を音楽プレイヤーに登録することかもしれません．  
この章では，機械学習とは何か，機械学習でどんなタスクを解決できるのか，そして機械学習で用いられる様々なアプローチについて見ていきます．
ここでは，機械学習アルゴリズムを実装するのに必要な最低限最低限の数学的知識も紹介します．
また，```Eigen``` や ```xtensor```，```Shark-ML```，```Shogun```，```Dlib``` のようなライブラリにおける基本的な線形代数演算の実行について説明し，例として線形回帰問題を見ていきます．

## 機械学習の基礎を理解する
機械学習モデルを作成し学習するには様々な方法があります．
ここでは，そうしたアプローチを概観し，それぞれの違いについて説明します．
機械学習モデルを作成するアプローチとは別に，モデルの学習時や評価時の挙動を制御するパラメータも存在ます．
モデルのパラメータは大きく2種類に分けることができ，それぞれ別々の方法で設定します．
また，機械学習のモデルを学習する技術もとても重要です．
通常，モデルの学習には目的関数を最小化する何らかの数値的な最適化手法が用いられます．
機械学習では目的関数は損失関数と呼ばれ，学習アルゴリズムがエラーを起こした際にペナルティを与えます．
ここでは，これらの概念をより詳細に議論していきます．

### 機械学習の技術に足を踏み入れる
機械学習のアプローチは大きく2つに分かれます．

- 教師あり学習 (supervised learning)  
  ラベル付されたデータに基づくアプローチ．
  ラベル付されたデータは既知のデータサンプルで，既知のターゲット出力と関連付がなされている．
- 教師なし学習 (unsupervised learning)  
  ラベル付されたデータが不要なアプローチで，任意の種類のデータについて隠されたパターンや構造を探索できる．

#### 教師あり学習
教師ありの機械学習アルゴリズムでは，通常，限られたラベル月データを用いて，新しいデータについて合理的な予測の可能なモデルの構築を行います．
教師あり学習はさらに大きく分類と回帰という2種類の手法に分けることができます．

- 分類モデル (classification model)
  有限数の明確なカテゴリを予測するモデルで，メールがスパムか否かを判定したり，画像に人の顔が映っているかどうかを判断できる．
  会話やテキストの認識，画像中の物体認識，信用度のスコアリングなどに適用する．
  典型的なアルゴリズムとしては SVM (Support Vector Machine) や決定木 (Decision tree)，k近傍法 (KNN: K-Nearest Neighbor)，ロジスティック回帰 (Logistic Regression),
  ナイーブ・ベイズ (Naive Bayes)，そしてニューラルネットワーク (NN: Neural Network) があります．
- 回帰モデル (regression model)  
  気温の変化や貨幣の交換レートのような連続的な値を予測するモデル．
  アルゴリズミックなトレーディングや電力利用の予測，収入予測などに用いられる．
  得られるラベル付きデータの出力が実数であるならば回帰モデルが適している．
  典型的な手法には線形回帰や多変量回帰 (linear / multivariate regression)，多項式回帰 (plynomial regression)，段階的回帰 (stepwise regression) などがある．
  また決定木やニューラルネットワークでも回帰は可能．

#### 教師なし学習
教師なし学習のアルゴリズムでは，ラベル付きデータは用いません．
予測を行うのに必要な隠されたパターンを見つけ出すのに，データの内在的な関係性を用いてモデルを構築します．
最もよく知られた教師なし学習手法はクラスタリング (clustering) です．
クラスタリングでは，与えられたデータを，そこに内在する性質によって有限数のグループに分割します．
この手法は，市場調査や様々なタイプの予備的な解析，DNA 解析，画像のセグメンテーション，物体検出に用いられます．
典型的なモデル構築手法としては，k 平均法 (k-means) や k-medois 法，ガウシアン混合モデル (Gaussian mixture model)，階層的クラスタリング (hierarchical clustering)，
隠れマルコフモデル (hidden Markov model) があります．

### 機械学習モデルを扱う
機械学習モデルは，様々なタイプのパラメータを取る関数として解釈できます．
そのような関数は，これらパラメータの値に基づいて，与えられた入力に対する出力を生成します．
モデルのパラメータを調整することで，問題を解決する機械学習モデルの挙動を設定できます．
機械学習モデルの学習は，よく最適なパラメータの組み合わせ探索として扱われます．
機械学習モデルのパラメータには大きく分けて2種類存在します．
1つ目がモデル内のパラメータで学習データからその値を推定できます．
もう1つがモデル外部のパラメータで，学習データからその値を推定することはできません．
この外部のパラメータは，しばしばハイパーパラメータ (hyperparameter) と呼ばれます．  
内部パラメータには次のような特徴があります．

- 予測に必要である
- 与えられた問題に対する性能を規定する
- 学習データから学習できる
- 通常，モデルの一部である

内部のパラメータ数が固定のモデルをパラメトリック (parametric) なモデル，そうでないものを ノンパラメトリック (non-parametric) なモデルと呼びます．
内部のパラメータには次のようなものがあります．

- 人工ニューラルネットワーク (ANN: Artificial Neural Network) の重み
- SVM モデルのサポートベクトルの値
- 線形回帰やロジスティック回帰の多項式係数

一方，ハイパーパラメータには次のような特徴があります．

- モデルパラメータを推定するアルゴリズムの設定に使われる
- 通常，開発者が指定する
- その予測はしばしばヒューリスティックに行われる
- 具体的なモデリング問題について特定の値を取る

ある問題を解くモデルのハイパーパラメータの最適値を求めるのは困難です．
また，モデルや学習アルゴリズムが最適な動作をするには，しばしば追加でハイパーパラメータのチューニングが必要になります．
経験則で決めたり，似たようなプロジェクトから取ってきたり，あるいはグリッドサーチのようなハイパーパラメータの推定主峰を用いて決定します．  
ハイパーパラメータには次のようなものがあります．

- SVM における分類の品質を設定する $C$ や $\sigma$
- アルゴリズムの収束を設定するニューラルネットワークの学習率
- 近傍数を指定する k-NN アルゴリズムの $k$

### モデルのパラメータ予測
